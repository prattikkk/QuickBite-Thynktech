# ============================================================
# QuickBite — Production Profile Configuration
# ============================================================
# Activate via: SPRING_PROFILES_ACTIVE=prod

# ── Database Connection Pool (HikariCP) ──
# Tuned for production workloads
spring.datasource.hikari.maximum-pool-size=${HIKARI_MAX_POOL:40}
spring.datasource.hikari.minimum-idle=${HIKARI_MIN_IDLE:10}
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.leak-detection-threshold=30000
spring.datasource.hikari.validation-timeout=5000

# ── JPA / Hibernate ──
spring.jpa.show-sql=false
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ── Logging — Structured JSON for ELK/Loki ──
logging.level.root=WARN
logging.level.com.quickbite=INFO
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN

# ── Security ──
# JWT tokens: shorter access, unchanged refresh
jwt.access-token-expiration-ms=900000

# ── Actuator — Restricted in production ──
management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoint.health.show-details=when-authorized

# ── Swagger — Disabled in production ──
springdoc.swagger-ui.enabled=false
springdoc.api-docs.enabled=false

# ── Server ──
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/plain,text/css,application/javascript
server.compression.min-response-size=1024

# ── Redis Cache ──
spring.cache.type=redis
spring.cache.redis.time-to-live=600000

# ── Rate Limiting — Stricter in production ──
rate-limit.requests-per-minute=${RATE_LIMIT_RPM:60}
rate-limit.auth-requests-per-minute=${RATE_LIMIT_AUTH_RPM:10}

# ── Sentry — Higher trace rate in production ──
sentry.environment=production
sentry.traces-sample-rate=${SENTRY_TRACES_RATE:0.1}
